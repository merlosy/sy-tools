"use strict";angular.module("sy-tools",["sy-tools.birthdate","sy-tools.browser","sy-tools.feedback","sy-tools.validation","sy-tools.railway"]),angular.module("sy-tools.birthdate",[]).run(["$templateCache",function(a){a.put("sy-tools/template/birthdate.html",['<div class="row" ng-cloak>','<div class="col-sm-4 col-xs-4" style="width:30%">','<input type="text" name="day" class="form-control" ng-model="day" maxlength=2 ','id="birthdate-jour" ng-change="setDateFromFields()" ','title="{{lang.title_day}}" placeholder="{{lang.placeholder_day}}" />',"</div>",'<div class="col-sm-4 col-xs-4" style="width:30%">','<input type="text" name="month" class="form-control" ng-model="month" maxlength=2','id="birthdate-mois" ng-change="setDateFromFields()" ','title="{{lang.title_month}}" placeholder="{{lang.placeholder_month}}" />',"</div>",'<div class="col-sm-4 col-xs-4" style="width:40%">','<div class="form-group has-feedback" style="margin-bottom:0">','<input type="text" name="year" class="form-control" ng-model="year" maxlength=4 ','id="birthdate-annee" ng-change="setDateFromFields()" ','title="{{lang.title_year}}" placeholder="{{lang.placeholder_year}}" />','<span class="glyphicon form-control-feedback glyphicon-asterisk"></span>',"</div>","</div>","</div>"].join(""))}]).constant("BIRTHDATE",{lang:{placeholder_day:"DD",placeholder_month:"MM",placeholder_year:"YYYY",title_day:"Day of birth",title_month:"Month of birth",title_year:"Year of birth"},separator:"/"}).directive("birthdate",["$log","$timeout","BIRTHDATE",function(a,b,c){var d=function(a){return angular.isUndefined(a)||null===a||""===a};return{restrict:"E",require:"ngModel",replace:!0,transclude:!0,templateUrl:"sy-tools/template/birthdate.html",scope:{dateValue:"=ngModel"},link:function(a,b,e,f){a.init=!0,a.lang=c.lang,a.setDateFromFields=function(){a.init=!1,a.day=angular.isDefined(a.day)?a.day.replace(/[^0-9]/g,""):"",a.month=angular.isDefined(a.month)?a.month.replace(/[^0-9]/g,""):"",a.year=angular.isDefined(a.year)?a.year.replace(/[^0-9]/g,""):"",a.dateValue=a.day+c.separator+a.month+c.separator+a.year};var g=function(b){if(b){var d=b.split(c.separator);a.day=d[0],a.month=d[1],a.year=d[2]}else a.day="",a.month="",a.year=""};g(a.dateValue),a.$watch("day",function(c,e){if(!d(c)||c!==e){var f=b.find("input");d(c)||2!==c.length||a.init||(f[1].focus(),f[1].select())}}),a.$watch("month",function(c,e){if(c||c!==e){var f=b.find("input");d(c)||2!==c.length||a.init||(f[2].focus(),f[2].select())}}),a.$watch("dateValue",function(a,b){a&&a!==b&&g(a)})}}}]),angular.module("sy-tools.browser",[]).constant("DEVICES",{ANDROID:"android",IPAD:"ipad",IPHONE:"iphone",IPOD:"ipod",BLACKBERRY:"blackberry",FIREFOXOS:"firefoxos",WINDOWSPHONE:"windows-phone",PS4:"ps4",VITA:"vita",UNKNOWN:"unknown"}).constant("OS",{WINDOWS:"windows",MAC:"mac",IOS:"ios",ANDROID:"android",LINUX:"linux",UNIX:"unix",FIREFOXOS:"firefoxos",WINDOWSPHONE:"windows-phone",PS4:"ps4",VITA:"vita",UNKNOWN:"unknown"}).constant("BROWSERS",{CHROME:{name:"chrome",pattern:"Chrome",minVersion:36},FIREFOX:{name:"firefox",pattern:"Firefox",minVersion:30},SAFARI:{name:"safari",pattern:"Safari",minVersion:536},OPERA:{name:"opera",pattern:"Opera"},IE:{name:"IE",pattern:"MSIE",minVersion:9},IE11:{name:"IE-trident",pattern:"Trident",minVersion:5},PS4:{name:"ps4",pattern:"Mozilla 5.0 (PlayStation 4"},VITA:{name:"vita",pattern:"Mozilla 5.0 (PlayStation Vita"},UNKNOWN:{name:"unknown",pattern:"unknown"}}).factory("Device",["$window","DEVICES","BROWSERS","OS",function(a,b,c,d){var e=a.navigator.userAgent,f=function(){this.userAgent=e,this.raw={os:{},browser:{},device:{}},this.browser={name:null,version:null},this.raw.os[d.WINDOWS]=/\bWindows\b/.test(e)&&!/\bWindows Phone\b/.test(e),this.raw.os[d.MAC]=/\bMac OS\b/.test(e),this.raw.os[d.IOS]=/\biPad\b/.test(e)||/\biPhone\b/.test(e)||/\biPod\b/.test(e),this.raw.os[d.ANDROID]=/\bAndroid\b/.test(e),this.raw.os[d.LINUX]=/\bLinux\b/.test(e),this.raw.os[d.UNIX]=/\bUNIX\b/.test(e),this.raw.os[d.FIREFOXOS]=/\bFirefox\b/.test(e)&&/\Mobile\b/.test(e),this.raw.os[d.WINDOWSPHONE]=/\bIEMobile\b/.test(e),this.raw.os[d.PS4]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(e),this.raw.os[d.VITA]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(e),this.raw.browser[c.CHROME.name]=/\bChrome\b/.test(e)||/\bCriOS\b/.test(e),this.raw.browser[c.FIREFOX.name]=/\Firefox\b/.test(e),this.raw.browser[c.SAFARI.name]=/^((?!CriOS).)*\Safari\b.*$/.test(e)&&!/\bChrome\b/.test(e),this.raw.browser[c.OPERA.name]=/\Opera\b/.test(e),this.raw.browser[c.IE.name]=/\bMSIE\b/.test(e)||/\Trident\b/.test(e),this.raw.browser[c.PS4.name]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(e),this.raw.browser[c.VITA.name]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(e),this.raw.device[b.ANDROID]=/\bAndroid\b/.test(e),this.raw.device[b.IPAD]=/\biPad\b/.test(e),this.raw.device[b.IPHONE]=/\biPhone\b/.test(e),this.raw.device[b.IPOD]=/\biPod\b/.test(e),this.raw.device[b.BLACKBERRY]=/\bblackberry\b/.test(e),this.raw.device[b.FIREFOXOS]=/\bFirefox\b/.test(e)&&/\Mobile\b/.test(e),this.raw.device[b.WINDOWSPHONE]=/\bIEMobile\b/.test(e),this.raw.device[b.PS4]=/\bMozilla\/5.0 \(PlayStation 4\b/.test(e),this.raw.device[b.VITA]=/\bMozilla\/5.0 \(Play(S|s)tation Vita\b/.test(e);var a,f=[],g=this.raw.os;for(a in d)f.push(d[a]);this.os=f.reduce(function(a,b){return a===d.UNKNOWN&&g[b]?b:a},d.UNKNOWN);var h=[],i=this.raw.browser;for(a in c)h.push(c[a].name);this.browser.name=h.reduce(function(a,b){return a===c.UNKNOWN.name&&i[b]?b:a},c.UNKNOWN.name);var j=[],k=this.raw.device;for(a in b)j.push(b[a]);this.device=j.reduce(function(a,c){return a===b.UNKNOWN&&k[c]?c:a},b.UNKNOWN);var l=c.UNKNOWN;for(a in c)c[a].name===this.browser.name&&(l=c[a]);var m=e.substr(e.indexOf(l.pattern)+l.pattern.length).match(/\d+(\.\d+)?/);this.browser.version=m.length>0?m[0]:"",this.isSupported=angular.isDefined(l.minVersion)?l.minVersion<=parseFloat(this.browser.version):!1};return f.prototype.isMobile=function(){return this.device!==b.UNKNOWN},f.prototype.isAndroid=function(){return this.device===b.ANDROID||this.OS===d.ANDROID},f.prototype.isIOS=function(){return this.os===d.IOS||this.device===b.IPOD||this.device===b.IPHONE},f}]).directive("deviceDetector",["Device","$log","$window","$sce",function(a,b,c,d){return{restrict:"E",replace:!0,template:'<div ng-show="!device.isSupported" class="alert alert-warning" role="alert" ng-bind-html="texte"></div>',link:function(c,e){c.device=new a,b.debug(c.device),c.content=JSON.stringify(c.device),c.texte=d.trustAsHtml("The browser is not supported by this application."),e.addClass("os-"+c.device.os),e.addClass("browser-"+c.device.browser.name),e.addClass("device-"+c.device.device)}}}]),angular.module("sy-tools.feedback",[]).constant("FEEDBACK",{unavailable:"The server is currently unavailable. Please, try again later.",failure:"An error has occured. Please, contact support or try again later.",level:{"default":"default",success:"success",info:"info",warning:"warning",danger:"danger"}}).constant("HTTP_CODE",{pattern4XX:/^4[0-9]{2}$/}).directive("syFeedback",["$log","Feedback",function(a,b){return{restrict:"E",replace:!0,template:'<div class="alert alert-{{alert.level}} alert-dismissible" role="alert" ng-repeat="alert in feedback.alerts"> 	<button ng-show="alert.closable" type="button" class="close" title="{{lang.actions.fermer.titre}}" data-dismiss="alert" ng-click="closeAlert($index)"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button> 		{{alert.message}} 		<ul ng-show="alert.array">  			<li ng-repeat="message in alert.array track by $index" ng-show="message.length>0">{{message}}</li> 		</ul> 	</div>',scope:{feedback:"=model"},link:function(a,b,c,d){a.closeAlert=function(b){a.feedback.alerts.splice(b,1)}}}}]).factory("Feedback",["$rootScope","$timeout","$log","HTTP_CODE","FEEDBACK",function(a,b,c,d,e){var f=function(a){return angular.isUndefined(a)||null===a||""===a},g=function(a,b){return JSON.stringify(a)===JSON.stringify(b)},h=function(a,b,c){var d={level:b||e.level["default"],closable:angular.isObject(c)&&angular.isDefined(c.closable)?c.closable:!0,message:angular.isObject(c)&&angular.isDefined(c.message)?c.message:e.failure};if(angular.isArray(a))switch(a.length){case 0:d.message=d.message;break;case 1:d.message=a[0];break;default:d.array=a}else d.message=f(a)?d.message:a;return d},i=function(a,b){var d=!1;for(var e in a)(angular.isDefined(b.message)&&a[e].message===b.message&&a[e].level===b.level||angular.isArray(b.array)&&g(a[e].array,b.array)&&a[e].level===b.level)&&(c.debug("Message duplicated"),d=!0);return d},j=function(){this.alerts=new Array};return j.prototype.local=function(a,b,c){var d=h(a,b,c);i(this.alerts,d)||this.alerts.push(d)},j.prototype.validation=function(a){this.local(a,e.level.danger)},j.prototype.error=function(a,b){c.debug(b);var f=new Array;switch(b.status){case 412:if(angular.isDefined(b.data)&&angular.isArray(b.data))for(var g=0;g<b.data.length;g++)if(f.push(b.data[g].message),angular.isDefined(b.data[g].nomParametres)&&angular.isArray(b.data[g].nomParametres))for(var j=0;j<b.data[g].nomParametres.length;j++){var k=b.data[g].nomParametres[j];a[k]={passes:!1}}break;case d.pattern4XX.test(b.status):f=e.failure;break;case 503:f=e.unavailable}var l=h(f,e.level.danger);i(this.alerts,l)||this.alerts.push(l)},j}]),angular.module("sy-tools.footer",[]).directive("footer",["$log","$window","$timeout",function(a,b,c){return{restrict:"E",link:function(a,d){var e=function(){var a=d[0].offsetHeight;d.css("margin-top","-"+a+"px"),angular.element("#page-wrapper > div:first-child").css("padding-bottom",a+"px")};angular.element(b).bind("resize",function(){c(function(){e()})}),e()}}}]),function(){function a(a,b,c){function d(){this.goNext=function(){this.next(),this.railway.next()},this.goBack=function(){this.previous(),this.railway.previous()}}function e(d,e){var f=d.ctrl,g={trimSteps:f.railwayTrimSteps?"true"===f.railwayTrimSteps:c.trimSteps,showLabels:f.railwayShowLabels?"true"===f.railwayShowLabels:c.showLabels,showButtons:f.railwayShowButtons?"true"===f.railwayShowButtons:c.showButtons,showTracks:f.railwayShowTracks?"true"===f.railwayShowTracks:c.showTracks};f.railway=new b(e,g),f.labels=[],a(function(){if(f.railway.options.showTracks){for(var a=f.railway.children.length,b=f.railway.children,c=100,d=0;d<b.length;d++)f.labels.push($(b[d]).attr("name"));if(a>1){var g=e.find(".railway-track").children();f.railway.options.trimSteps?(c=100/(a-1),g.css("width",c+"%").addClass("fitted"),angular.element(g[0]).css("width",c/2+"%"),angular.element(g[g.length-1]).css("width",c/2+"%")):(c=100/a,g.css("width",c+"%"))}else angular.element(".railway-track > div").css("width",c+"%")}})}return{restrict:"E",replace:!1,transclude:!0,require:"?ngModel",template:['<div class="railway-row-track" >','<div class="railway-row-col">','<div class="railway-track" ng-if="ctrl.railway.options.showTracks"><div ng-repeat="child in ctrl.railway.children track by $index" ng-class="{\'active\':ctrl.railway.current>=$index}">',"<div></div><div title={{ctrl.labels[$index]}}>{{$index+1}}</div><div></div>",'<span ng-show="ctrl.railway.options.showLabels" ng-bind="ctrl.labels[$index]"></span>',"</div></div>","</div> </div>",'<div class="railway" ng-transclude></div>','<div class="text-center railway-btn-group" ng-show="ctrl.railway.children.length>0 && ctrl.railway.options.showButtons">','<button class="btn btn-primary btn-railway" ng-disabled="!ctrl.railway.hasPrevious()" ng-click="ctrl.goBack()" >Previous</button>','<button class="btn btn-primary btn-railway" ng-disabled="!ctrl.railway.hasNext()" ng-click="ctrl.goNext()" >Next</button>','<button class="btn btn-success btn-railway" ng-show="ctrl.railway.isLast()" ng-click="ctrl.complete()" >Finish</button>',"</div>"].join(""),controllerAs:"ctrl",bindToController:!0,scope:{railway:"=?ngModel",complete:"&onComplete",next:"&onNext",previous:"&onPrevious",railwayTrimSteps:"@?",railwayShowLabels:"@?",railwayShowButtons:"@?",railwayShowTracks:"@?"},link:e,controller:d}}function b(){var a=function(a,b){if(this.children=a.children(".railway").children("railway-station"),this.element=a,this.options=b,this.current=!1,this.children.length>0){this.current=0,$(this.children[0]).css("display","block");for(var c=1;c<this.children.length;c++)$(this.children[c]).css("display","none")}};return a.prototype.next=function(){this.current<this.children.length-1&&($(this.children[this.current]).css("display","none"),$(this.children[++this.current]).css("display","block"))},a.prototype.previous=function(){this.current>0&&($(this.children[this.current]).css("display","none"),$(this.children[--this.current]).css("display","block"))},a.prototype.hasNext=function(){return this.current<this.children.length-1},a.prototype.hasPrevious=function(){return this.current>0},a.prototype.isLast=function(){return this.current===this.children.length-1},a}angular.module("sy-tools.railway",[]),angular.module("sy-tools.railway").constant("RAILWAY",{trimSteps:!0,showLabels:!0,showTracks:!0,showButtons:!0}),angular.module("sy-tools.railway").factory("Railway",[b]).directive("railway",["$timeout","Railway","RAILWAY",a])}(),function(){var a=angular.module("sy-tools.validation",[]),b=/^\-?\d+$/,c=/^\-?\d+(\,\d+)?$/,d=/^\-?\d+(\.\d+)?$/,e=/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/,f=/^[0-9]{5}$/,g=/^[0-9]{6}([aAbB]|[0-9])[0-9]{6}$/,h=/^[0-9A-Za-z]*$/,i=/^[A-Za-zÀÂÄÇÉÈÊËÎÏÔÖÙÛÜŸàâäçéèêëîïôöùûüÿÆŒæœ\-\' ]*$/,j=/^[A-Za-z \-]*$/,k=/^[A-Za-z]*$/,l=/^(\+[1-9]|[0-9]{2})[0-9]{7,13}$/;a.factory("Validation",["$log","$filter",function(a,m){var n=function(a){return angular.isUndefined(a)||null===a||""===a},o=function(o,p){var q,r,s,t,u,v,w=!1,x=function(a){return"[object Date]"!==Object.prototype.toString.call(a)?!1:!isNaN(a.getTime())};switch(p.key){case"isTrue":w=p.value===!0;break;case"integer":w=n(o)||b.test(o);break;case"nir":w=g.test(o);break;case"tel":w=n(o)||l.test(o);break;case"postcode":w=f.test(o);break;case"alphadashspace":w=j.test(o);break;case"alphanumeric":w=h.test(o);break;case"alphachars":w=i.test(o);break;case"alpha":w=k.test(o);break;case"floatfr":w=c.test(o);break;case"floateng":w=d.test(o);break;case"array":w=angular.isArray(o);break;case"inarray":w=void 0!==o&&p.value.indexOf(o)>-1;break;case"email":w=e.test(o);break;case"date":q=new Date,o instanceof Date?q=o:void 0!==o&&(r=o.split("/"),s=parseInt(r[0],10),t=parseInt(r[1],10),u=parseInt(r[2],10),q=new Date(u,t-1,s)),v=m("date")(q,"dd/MM/yyyy"),w=void 0!==o&&x(q)&&v===o;break;case"datebefore":q=new Date,void 0!==o&&(r=o.split("/"),s=parseInt(r[0],10),t=parseInt(r[1],10),u=parseInt(r[2],10),q=new Date(u,t-1,s)),w=q<p.value;break;case"boolean":w=void 0!==o&&"boolean"==typeof o;break;case"min":w=parseFloat(o)>=p.value;break;case"max":w=parseFloat(o)<=p.value;break;case"equal":w=o===p.value;break;case"length":w=void 0!==o&&String(o).length===p.value;break;case"minlength":w=void 0!==o&&String(o).length>=p.value;break;case"maxlength":w=void 0===o||String(o).length<=p.value;break;case"required":w=void 0!==o&&""!==o&&null!==o||angular.isArray(o)&&o.length>0||o instanceof Date||"boolean"==typeof o}return a.debug("check for "+o+" as "+p.key+" is "+w),w},p=function(a){var b=[];for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];b=b.concat(d.messages)}return b},q=function(){this.done=!1,this.fields=[]};return q.prototype.add=function(a,b,c,d){for(var e=!0,f=[],g=0;g<c.length;g++){var h=o(b,c[g]);if(e=e&&h,!h&&(void 0!==c[g].message&&""!==c[g].message&&f.push(c[g].message),void 0!==d&&d))break}return this.fields[a]={passes:e,messages:f},this.fields[a]},q.prototype.get=function(a){return this.fields[a]},q.prototype.isValid=function(){var a=!0;for(var b in this.fields)if(this.fields.hasOwnProperty(b)){var c=this.fields[b];a=a&&c.passes}else a=!1;return a},q.prototype.errorsAsString=function(){return p(this.fields).join(" ")},q.prototype.errorsAsArray=function(){return p(this.fields)},q}])}();